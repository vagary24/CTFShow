$(function(){function t(t){if(w)return void(window.location.href="https://link.csdn.net?from_id="+articleId+"&target="+encodeURIComponent(t));var e=document.createElement("a");e.style.display="none",e.href="https://link.csdn.net?from_id="+articleId+"&target="+encodeURIComponent(t),e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)}function e(){return!!window.navigator.userAgent.toLowerCase().match(/(csdn)/i)||!!h}function o(t,e){if(void 0!==typeof t&&null!==t&&""!==t)return t=t.toLowerCase(),class_name="hl-1",e&&(class_name="hl-git-1"),class_name}function n(t){return void 0===t||null===t||""===t}function i(t,e){n(e)||(e=e.toLowerCase().replace(/(^\s*)|(\s*$)/g,""),n(e)||(e.indexOf(",")>0?$.each(e.split(","),function(e,o){i(t,o)}):"..."!==e&&e.length>1&&"&nbsp;"!==e&&"csdn"!==e&&"||"!==e&&(t[e]=0)))}function r(t){var e={},o=t.join(",");i(e,o);var n=Object.keys(e);return n.sort(function(t,e){return e.length-t.length}),n}function a(t,n,i){for(var r=(n.html(),""),a=n.context.childNodes,c=0;c<a.length;c++){var s=a[c];if("#text"===s.nodeName){var d=s.textContent.replace(/</gi,"&lt;"),h=/[\u4e00-\u9fa5]/gi,p=t.map(function(t){var e=t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return h.test(e)?e:"\\b"+e+"\\b"}),f=new RegExp(p.join("|"),"ig"),w=!1;d=d.replace(f,function(t){var n=t.toLowerCase(),r="https://so.csdn.net/so/search?q="+encodeURIComponent(t)+"&spm=1001.2101.3001.7020";r=e()?"csdnapp://app.csdn.net/search/searchRoot?keyword="+encodeURIComponent(t)+"&t=blog&u="+username+"&from_tracking_code=art_highlight_word&from_code=app_blog_art&backSearch=true":r;var a=e()?'{"key_word":"'+t+'","spm":"1001.2101.3001.7020",}':'{"spm":"1001.2101.3001.7020","dest":"'+r+'","extra":"{\\"searchword\\":\\"'+t+'\\"}"}';return i&&(a='{"spm":"1001.2101.3001.10283","extra":"{\\"words\\":\\"'+t+'\\"}"}'),l[n]>=1||u===n||w?t:(w=!0,l[n]=l[n]?l[n]+1:1,u=n,e()?'<a data-href="'+r+'" class="app-hl hl '+o(n)+'" data-track-view='+a+" data-report-click="+a+">"+t+"</a>":i?'<span class="words-blog '+o(n,"gitcode")+'" data-report-view='+a+" data-tit="+t+" data-pretit="+u+">"+t+"</span>":'<a href="'+r+'" target="_blank" class="hl '+o(n)+'" data-report-view='+a+" data-report-click="+a+" data-tit="+t+" data-pretit="+u+">"+t+"</a>")}),r+=d}else r+=s.outerHTML?s.outerHTML:""}n[0].innerHTML=r,e()?($(window).on("scroll",function(){k.viewCheck()}),k.viewCheck()):window.csdn.report.viewCheck()}function c(){$("a.app-hl").off("click"),$("a.app-hl").click(function(t){t.preventDefault();var e=$(this).data("href"),o=$(this).attr("data-report-click"),n={action:"app_blog_highlight",trackingInfo:o,trackingCode:"art_highlight_word"},i={url:e};f&&(window.jsCallBackListener.csdntrackevent(JSON.stringify(n)),window.jsCallBackListener.csdnjumpnewpage(JSON.stringify(i))),w&&(window.webkit.messageHandlers.csdntrackevent.postMessage(JSON.stringify(n)),window.webkit.messageHandlers.csdnjumpnewpage.postMessage(JSON.stringify(i)))})}function s(){window.keyword_list_init=!0,$.ajax({type:"GET",url:"https://redisdatarecall.csdn.net/recommend/get_head_word?bid=blog-"+articleId,dataType:"json",timeout:2e3,xhrFields:{withCredentials:!0},success:function(t){if(200==t.status&&t.content){var o=r(t.content),n=t.ext?t.ext:{};if(void 0===o||0===o.length)return;var i=[];if(o.forEach(function(t,e){t=t.toLowerCase(),g.indexOf(t)==-1&&i.push(t)}),void 0===i||0===i.length)return;window.keyword_list=i,window.keyword_list_json=n;var s=$("#content_views").find("p,h1,h2,h3,h4,h5,h6");window.keyword_list_doms=s,$.each(s,function(t,e){var e=$(e);a(i,e)}),e()&&c()}}})}function d(){var t=lastTime?lastTime:postTime;t=new Date(t).getTime(),$.ajax({url:"https://clink-api.gitcode.com/api/v1/highlight/get",type:"get",xhrFields:{crossDomain:!0,withCredentials:!0},data:{article_id:articleId,username:username,updated_at:t},success:function(t){},error:function(t){}})}if(!isGitCodeBlog){var l={},u="",h=!!window.isApp&&window.isApp,p=navigator.userAgent,f=p.indexOf("Android")>-1||p.indexOf("Adr")>-1||p.indexOf("OHOS")>-1,w=!!p.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),g=r(privateData)||[];if(!h&&g&&g.length>0){var m=$("#content_views").find("p,h1,h2,h3,h4,h5,h6");$.each(m,function(t,e){var e=$(e);a(g,e,!0)});var v=!0;$(document).on("click",".words-blog",function(){var e=$(this).data("pretit").toLowerCase();v&&(v=!1,$.ajax({url:"https://web-api.gitcode.com/api/v1/search/nauth/project/words",type:"get",data:{words:e},xhrFields:{crossDomain:!0,withCredentials:!0},success:function(o){var n="";200==o.status&&o.data&&o.data[e]?(t(o.data[e]),n=o.data[e]):t("https://gitcode.com?utm_source=highlight_word_gitcode&is_default=1&word="+e),window.csdn.report.reportClick({spm:"1001.2101.3001.10283",extra:{words:e},dest:n}),v=!0},error:function(o){t("https://gitcode.com?utm_source=highlight_word_gitcode&is_default=1&word="+e),v=!0}}))})}var _,k={scrollTop:function(){return Math.max(document.body.scrollTop,document.documentElement.scrollTop)},windowHeight:function(){return"CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight},getElementBottom:function(t){if("undefined"!=typeof jQuery)return $(t).offset().top+$(t).height();var e=t.offsetTop;for(t=t.offsetParent;null!=t;)e+=t.offsetTop,t=t.offsetParent;return e},isView:function(t){var e=this;if(!t)return!1;var o=k.getElementBottom(t),n=o+t.offsetHeight;return e.scrollTop()<o&&o<e.scrollTop()+e.windowHeight()||e.scrollTop()<n&&n<e.scrollTop()+e.windowHeight()},reportView:function(t){console.log("app report exposure",t),f&&(console.log("isAndroid"),window.jsCallBackListener.csdntrackexpo(JSON.stringify(t))),w&&(console.log("isiOS"),window.webkit.messageHandlers.csdntrackexpo.postMessage(JSON.stringify(t)))},viewCheck:function(){clearTimeout(_),_=setTimeout(function(){$("[data-track-view]").each(function(){var t=$(this);if(k.isView(t.get(0))){var e=t.attr("data-track-view"),o={trackingCode:"art_highlight_word",trackingInfo:e,action:"app_blog_highlight"};k.reportView(o),t.removeData("trackView"),t.removeAttr("data-track-view")}})},200)}};s();var b=$("#keywordDecBox");b.length&&($(document).on("mouseover","#article_content .hl",function(){var t=$(this).attr("data-tit"),e=$(this).attr("data-pretit"),o=Object(keyword_list_json)[e];if(t&&o){var n=$(this).offset().left,i=$(this).offset().top,r=$(this).outerHeight(!0),a='<span class="tit">'+t+'</span><span class="dec">'+o+"</span>";b.html(a).css({left:n,top:i+r}).show()}}),$(document).on("mouseout","#article_content .hl",function(){b.hide()}),b.on({mouseover:function(){$(this).show()},mouseout:function(){$(this).hide()}})),h||d()}}),function(){function t(){return!!window.navigator.userAgent.toLowerCase().match(/(phone|pad|pod|iphone|ipod|ios|ipad|android|mobile|blackberry|iemobile|mqqbrowser|juc|fennec|wosbrowser|browserng|webos|symbian|windows phone)/i)}function e(){return!!window.navigator.userAgent.toLowerCase().match(/(csdn)/i)}function o(){var o=null,n=[];if(t())o=document.querySelectorAll('[class^="container-fluid container-fluid-flex container-"]'),n=document.querySelectorAll(".container-fluid.bdinsert");else{if(e())return!1;o=document.querySelectorAll("div[class^='recommend-item-box type_'],div.recommend-item-box.baiduSearch"),n=document.querySelectorAll("div.recommend-item-box.baiduSearch")}o=null!==o?o.length:0;var i=o-n.length;0===i&&$.get("https://statistic.csdn.net/blog/recommend?count="+i+"&baiducount="+n.length+"&articleId="+articleId)}o()}();